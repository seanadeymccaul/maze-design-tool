<html>
<head>
<title>Maze.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
.s5 { color: #629755; font-style: italic;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Maze.java</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">javax.imageio.ImageIO</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">javax.swing.*</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.awt.*</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.awt.image.BufferedImage</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.io.File</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.io.IOException</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.sql.SQLException</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.text.SimpleDateFormat</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.util.ArrayList</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.util.Arrays</span><span class="s0">;</span>
<span class="s0">import </span><span class="s1">java.util.LinkedList</span><span class="s0">;</span>

<span class="s0">abstract class </span><span class="s1">Maze {</span>

    <span class="s2">// Fields</span>

    <span class="s0">private </span><span class="s1">String name</span><span class="s0">;</span>
    <span class="s0">public </span><span class="s1">String GetName(){</span><span class="s0">return </span><span class="s1">name</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public void </span><span class="s1">SetName(String n){name = n</span><span class="s0">;</span><span class="s1">}</span>

    <span class="s0">private </span><span class="s1">String author</span><span class="s0">;</span>
    <span class="s0">public </span><span class="s1">String GetAuthor(){</span><span class="s0">return </span><span class="s1">author</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public void </span><span class="s1">SetAuthor(String n){author = n</span><span class="s0">;</span><span class="s1">}</span>

    <span class="s0">protected </span><span class="s1">MazeDataCell[] mazeData</span><span class="s0">;</span>
    <span class="s0">public </span><span class="s1">MazeDataCell[] GetMazeData(){</span><span class="s0">return </span><span class="s1">mazeData</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public void </span><span class="s1">SetMazeData(MazeDataCell[] d){mazeData = d</span><span class="s0">;</span><span class="s1">}</span>

    <span class="s0">protected </span><span class="s1">MazeDisplayCell[] displayData</span><span class="s0">;</span>
    <span class="s0">public </span><span class="s1">MazeDisplayCell[] GetDisplayData(){</span><span class="s0">return </span><span class="s1">displayData</span><span class="s0">;</span><span class="s1">}</span>

    <span class="s0">protected int </span><span class="s1">xDimension</span><span class="s0">, </span><span class="s1">yDimension</span><span class="s0">, </span><span class="s1">cellCount</span><span class="s0">, </span><span class="s1">logoIndex</span><span class="s0">, </span><span class="s1">logoWidth</span><span class="s0">, </span><span class="s1">logoHeight</span><span class="s0">;</span>
    <span class="s0">public int </span><span class="s1">GetXDimension(){</span><span class="s0">return </span><span class="s1">xDimension</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public int </span><span class="s1">GetYDimension(){</span><span class="s0">return </span><span class="s1">yDimension</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public int </span><span class="s1">GetCellCount(){</span><span class="s0">return </span><span class="s1">cellCount</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public void </span><span class="s1">SetXDimension(</span><span class="s0">int </span><span class="s1">x){xDimension = x</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public void </span><span class="s1">SetYDimension(</span><span class="s0">int </span><span class="s1">y){yDimension = y</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public void </span><span class="s1">SetImageList(ArrayList&lt;MazeImage&gt; a){imageList = a</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public </span><span class="s1">ArrayList&lt;Integer&gt; solutionDirections = </span><span class="s0">new </span><span class="s1">ArrayList&lt;&gt;()</span><span class="s0">;</span>

    <span class="s0">protected </span><span class="s1">String lastEditTime</span><span class="s0">;</span>
    <span class="s0">public </span><span class="s1">String GetLastEditTime(){</span><span class="s0">return </span><span class="s1">lastEditTime</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public void </span><span class="s1">SetLastEditTime(String s){lastEditTime = s</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">protected </span><span class="s1">String creationTime</span><span class="s0">;</span>
    <span class="s0">public </span><span class="s1">String GetCreationTime(){</span><span class="s0">return </span><span class="s1">creationTime</span><span class="s0">;</span><span class="s1">}</span>
    <span class="s0">public void </span><span class="s1">SetCreationTime(String c){creationTime = c</span><span class="s0">;</span><span class="s1">}</span>

    <span class="s0">protected </span><span class="s1">ArrayList&lt;MazeImage&gt; imageList</span><span class="s0">;</span>
    <span class="s0">public </span><span class="s1">ArrayList&lt;MazeImage&gt; GetImageList(){</span><span class="s0">return </span><span class="s1">imageList</span><span class="s0">;</span><span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">paintSolution = </span><span class="s0">false;</span>
    <span class="s0">public int </span><span class="s1">cellsReached</span><span class="s0">;</span>
    <span class="s0">public int </span><span class="s1">deadEnds</span><span class="s0">;</span>

    <span class="s2">// Default constructor</span>

    <span class="s0">public </span><span class="s1">Maze() </span><span class="s0">throws </span><span class="s1">SQLException { }</span>


    <span class="s2">// New maze constructor</span>

    <span class="s0">public </span><span class="s1">Maze(String name</span><span class="s0">,</span><span class="s1">String author</span><span class="s0">, int </span><span class="s1">xDimension</span><span class="s0">, int </span><span class="s1">yDimension) </span><span class="s0">throws </span><span class="s1">SQLException</span><span class="s0">, </span><span class="s1">IOException {</span>
        <span class="s0">this</span><span class="s1">.name = name</span><span class="s0">;</span>
        <span class="s0">this</span><span class="s1">.author = author</span><span class="s0">;</span>
        <span class="s0">this</span><span class="s1">.xDimension = xDimension</span><span class="s0">;</span>
        <span class="s0">this</span><span class="s1">.yDimension = yDimension</span><span class="s0">;</span>
        <span class="s0">this</span><span class="s1">.cellCount = xDimension * yDimension</span><span class="s0">;</span>
        <span class="s0">this</span><span class="s1">.mazeData = </span><span class="s0">new </span><span class="s1">MazeDataCell[</span><span class="s0">this</span><span class="s1">.cellCount]</span><span class="s0">;</span>
        <span class="s0">this</span><span class="s1">.lastEditTime = </span><span class="s0">new </span><span class="s1">SimpleDateFormat(</span><span class="s3">&quot;yyyy.MM.dd.HH.mm.ss&quot;</span><span class="s1">).format(</span><span class="s0">new </span><span class="s1">java.util.Date())</span><span class="s0">;</span>
        <span class="s0">this</span><span class="s1">.imageList = </span><span class="s0">new </span><span class="s1">ArrayList&lt;MazeImage&gt;()</span><span class="s0">;</span>
    <span class="s1">}</span>




    <span class="s2">// Generates a blank canvas</span>

    <span class="s0">public void </span><span class="s1">GenerateBlankMaze() </span><span class="s0">throws </span><span class="s1">IOException</span><span class="s0">, </span><span class="s1">SQLException {</span>
        <span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s4">0</span><span class="s0">; </span><span class="s1">i &lt; </span><span class="s0">this</span><span class="s1">.cellCount</span><span class="s0">; </span><span class="s1">i++){</span>
            <span class="s0">int </span><span class="s1">id = </span><span class="s4">1</span><span class="s0">, </span><span class="s1">wallAbove = </span><span class="s4">0</span><span class="s0">, </span><span class="s1">wallBelow = </span><span class="s4">0</span><span class="s0">, </span><span class="s1">wallLeft = </span><span class="s4">0</span><span class="s0">, </span><span class="s1">wallRight = </span><span class="s4">0</span><span class="s0">;</span>
            <span class="s0">if </span><span class="s1">(CheckTopBorder(i)){</span>
                <span class="s1">wallAbove = </span><span class="s4">1</span><span class="s0">;</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(CheckBottomBorder(i)){</span>
                <span class="s1">wallBelow = </span><span class="s4">1</span><span class="s0">;</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(CheckLeftBorder(i)){</span>
                <span class="s1">wallLeft = </span><span class="s4">1</span><span class="s0">;</span>
            <span class="s1">}</span>
            <span class="s0">if </span><span class="s1">(CheckRightBorder(i)){</span>
                <span class="s1">wallRight = </span><span class="s4">1</span><span class="s0">;</span>
            <span class="s1">}</span>
            <span class="s0">this</span><span class="s1">.mazeData[i] = </span><span class="s0">new </span><span class="s1">MazeDataCell(id</span><span class="s0">,</span><span class="s1">wallLeft</span><span class="s0">,</span><span class="s1">wallRight</span><span class="s0">,</span><span class="s1">wallAbove</span><span class="s0">,</span><span class="s1">wallBelow)</span><span class="s0">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>


    <span class="s2">// Generates a fully populated maze with solution</span>

    <span class="s0">public void </span><span class="s1">GenerateAutoMaze() </span><span class="s0">throws </span><span class="s1">IOException</span><span class="s0">, </span><span class="s1">SQLException {</span>
        <span class="s0">int </span><span class="s1">i = </span><span class="s4">0</span><span class="s0">;</span>
        <span class="s1">String lastMove = </span><span class="s3">&quot;&quot;</span><span class="s0">;</span>
        <span class="s0">while </span><span class="s1">(i &lt; (xDimension * yDimension)){</span>
            <span class="s0">if </span><span class="s1">(i + </span><span class="s4">1 </span><span class="s1">== (xDimension * yDimension) || i + xDimension == (xDimension * yDimension)){</span>
                <span class="s1">i = </span><span class="s4">0</span><span class="s0">;</span>
                <span class="s0">while </span><span class="s1">(i &lt; xDimension * yDimension){</span>
                    <span class="s0">if </span><span class="s1">(mazeData[i].getValue() == </span><span class="s4">1</span><span class="s1">){</span>
                        <span class="s0">int </span><span class="s1">random = GetRandomInt(</span><span class="s4">5</span><span class="s1">)</span><span class="s0">;</span>
                        <span class="s0">if </span><span class="s1">(random == </span><span class="s4">0</span><span class="s1">){</span>
                            <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s1">)</span><span class="s0">,</span><span class="s1">i)</span><span class="s0">;</span>
                        <span class="s1">} </span><span class="s0">else if </span><span class="s1">(random == </span><span class="s4">1</span><span class="s1">){</span>
                            <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s1">)</span><span class="s0">,</span><span class="s1">i)</span><span class="s0">;</span>
                        <span class="s1">} </span><span class="s0">else if </span><span class="s1">(random == </span><span class="s4">2</span><span class="s1">){</span>
                            <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s1">)</span><span class="s0">,</span><span class="s1">i)</span><span class="s0">;</span>
                        <span class="s1">} </span><span class="s0">else if </span><span class="s1">(random == </span><span class="s4">3</span><span class="s1">){</span>
                            <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s1">)</span><span class="s0">,</span><span class="s1">i)</span><span class="s0">;</span>
                        <span class="s1">} </span><span class="s0">else if </span><span class="s1">(random == </span><span class="s4">4</span><span class="s1">) {</span>
                            <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s1">)</span><span class="s0">,</span><span class="s1">i)</span><span class="s0">;</span>
                        <span class="s1">} </span><span class="s0">else if </span><span class="s1">(random == </span><span class="s4">5</span><span class="s1">) {</span>
                            <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">1</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">i)</span><span class="s0">;</span>
                        <span class="s1">}</span>

                    <span class="s1">}</span>
                    <span class="s1">i++</span><span class="s0">;</span>
                <span class="s1">}</span>
                <span class="s0">return;</span>
            <span class="s1">}</span>
            <span class="s0">int </span><span class="s1">rand = GetRandomInt(</span><span class="s4">2</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s0">if </span><span class="s1">(rand == </span><span class="s4">0</span><span class="s1">) {</span>
                <span class="s0">if </span><span class="s1">(!CheckRightBorder(i)) {</span>
                    <span class="s0">if </span><span class="s1">(lastMove == </span><span class="s3">&quot;vertical&quot;</span><span class="s1">){</span>
                        <span class="s2">// get the cell and change bottom to border, and right side to no border</span>
                        <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">4</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s1">)</span><span class="s0">,</span><span class="s1">i)</span><span class="s0">;</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(mazeData[i + </span><span class="s4">1</span><span class="s1">].getValue() != </span><span class="s4">3</span><span class="s1">){</span>
                        <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">4</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">i + </span><span class="s4">1</span><span class="s1">)</span><span class="s0">;  </span><span class="s2">// cell with value 4;</span>
                    <span class="s1">}</span>
                    <span class="s1">i = i + </span><span class="s4">1</span><span class="s0">;</span>
                    <span class="s1">lastMove = </span><span class="s3">&quot;horizontal&quot;</span><span class="s0">;</span>
                <span class="s1">}</span>
            <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
                <span class="s0">if </span><span class="s1">(!CheckBottomBorder(i)) {</span>
                    <span class="s2">//</span>
                    <span class="s0">if </span><span class="s1">(lastMove == </span><span class="s3">&quot;horizontal&quot;</span><span class="s1">){</span>
                        <span class="s2">// get the cell and change bottom to border, and right side to no border</span>
                        <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">4</span><span class="s0">,</span><span class="s4">0</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">1</span><span class="s0">,</span><span class="s4">0</span><span class="s1">)</span><span class="s0">,</span><span class="s1">i)</span><span class="s0">;</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(mazeData[i + xDimension].getValue() != </span><span class="s4">3</span><span class="s1">){</span>
                        <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">4</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">i + xDimension)</span><span class="s0">;  </span><span class="s2">// cell with value 4</span>
                    <span class="s1">}</span>
                    <span class="s1">i = i + xDimension</span><span class="s0">;</span>
                    <span class="s1">lastMove = </span><span class="s3">&quot;vertical&quot;</span><span class="s0">;</span>
                <span class="s1">}</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s2">// Override by adult and child classes</span>

    <span class="s0">public void </span><span class="s1">GenerateDisplayData() </span><span class="s0">throws </span><span class="s1">IOException { }</span>

    <span class="s2">//</span>
    <span class="s0">public void </span><span class="s1">ReplaceCell(MazeDataCell newCell</span><span class="s0">, int </span><span class="s1">cellIndex){</span>

        <span class="s1">MazeDataCell replacement = </span><span class="s0">new </span><span class="s1">MazeDataCell(newCell.getValue()</span><span class="s0">,</span><span class="s1">newCell.getWallLeft()</span><span class="s0">,</span><span class="s1">newCell.getWallRight()</span><span class="s0">,</span>
                <span class="s1">newCell.getWallAbove()</span><span class="s0">,</span><span class="s1">newCell.getWallBelow())</span><span class="s0">;</span>

        <span class="s0">if </span><span class="s1">(CheckTopBorder(cellIndex)){</span>
            <span class="s1">replacement.setWallAbove(</span><span class="s4">1</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
            <span class="s0">this</span><span class="s1">.mazeData[cellIndex - xDimension].setWallBelow(replacement.getWallAbove())</span><span class="s0">;</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(CheckBottomBorder(cellIndex)){</span>
            <span class="s1">replacement.setWallBelow(</span><span class="s4">1</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
            <span class="s0">this</span><span class="s1">.mazeData[cellIndex + xDimension].setWallAbove(replacement.getWallBelow())</span><span class="s0">;</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(CheckLeftBorder(cellIndex)){</span>
            <span class="s1">replacement.setWallLeft(</span><span class="s4">1</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
            <span class="s0">this</span><span class="s1">.mazeData[cellIndex - </span><span class="s4">1</span><span class="s1">].setWallRight(replacement.getWallLeft())</span><span class="s0">;</span>
        <span class="s1">}</span>
        <span class="s0">if </span><span class="s1">(CheckRightBorder(cellIndex)){</span>
            <span class="s1">replacement.setWallRight(</span><span class="s4">1</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">} </span><span class="s0">else </span><span class="s1">{</span>
            <span class="s0">this</span><span class="s1">.mazeData[cellIndex + </span><span class="s4">1</span><span class="s1">].setWallLeft(replacement.getWallRight())</span><span class="s0">;</span>
        <span class="s1">}</span>
        <span class="s0">this</span><span class="s1">.mazeData[cellIndex] = replacement</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">CheckTopBorder(</span><span class="s0">int </span><span class="s1">cellIndex){</span>
        <span class="s0">if </span><span class="s1">(cellIndex &lt; </span><span class="s0">this</span><span class="s1">.xDimension){</span>
            <span class="s0">return true;</span>
        <span class="s1">}</span>
        <span class="s0">return false;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">CheckBottomBorder(</span><span class="s0">int </span><span class="s1">cellIndex){</span>
        <span class="s0">if </span><span class="s1">(cellIndex &gt;= </span><span class="s0">this</span><span class="s1">.xDimension * (</span><span class="s0">this</span><span class="s1">.yDimension - </span><span class="s4">1</span><span class="s1">)){</span>
            <span class="s0">return true;</span>
        <span class="s1">}</span>
        <span class="s0">return false;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">CheckLeftBorder(</span><span class="s0">int </span><span class="s1">cellIndex){</span>
        <span class="s0">if </span><span class="s1">(cellIndex%</span><span class="s0">this</span><span class="s1">.xDimension == </span><span class="s4">0</span><span class="s1">){</span>
            <span class="s0">return true;</span>
        <span class="s1">}</span>
        <span class="s0">return false;</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">CheckRightBorder(</span><span class="s0">int </span><span class="s1">cellIndex){</span>
        <span class="s0">if </span><span class="s1">(cellIndex%</span><span class="s0">this</span><span class="s1">.xDimension == </span><span class="s0">this</span><span class="s1">.xDimension - </span><span class="s4">1</span><span class="s1">){</span>
            <span class="s0">return true;</span>
        <span class="s1">} </span><span class="s0">else if </span><span class="s1">(cellIndex + </span><span class="s4">1 </span><span class="s1">== </span><span class="s0">this</span><span class="s1">.cellCount){</span>
            <span class="s0">return true;</span>
        <span class="s1">}</span>
        <span class="s0">return false;</span>
    <span class="s1">}</span>

    <span class="s0">protected int </span><span class="s1">GetRandomInt(</span><span class="s0">int </span><span class="s1">max){</span>
        <span class="s0">return </span><span class="s1">(</span><span class="s0">int</span><span class="s1">)(Math.random()*max)</span><span class="s0">;</span>
    <span class="s1">}</span>

    <span class="s0">public void </span><span class="s1">InsertImage(MazeImage mazeImage) </span><span class="s0">throws </span><span class="s1">IOException {</span>

        <span class="s0">if </span><span class="s1">((mazeImage.GetIndex() + mazeImage.GetWidth() + ((mazeImage.GetHeight()-</span><span class="s4">1</span><span class="s1">) * xDimension) &lt;= xDimension*yDimension)){</span>
            <span class="s0">int </span><span class="s1">scaledWidth = mazeImage.GetWidth() * </span><span class="s4">2000 </span><span class="s1">/ xDimension</span><span class="s0">;</span>
            <span class="s0">int </span><span class="s1">scaledHeight = (mazeImage.GetHeight() * </span><span class="s4">2000 </span><span class="s1">/ yDimension)</span><span class="s0">;</span>
            <span class="s2">// read input image</span>
            <span class="s1">File inputFile = </span><span class="s0">new </span><span class="s1">File(mazeImage.GetPath())</span><span class="s0">;</span>
            <span class="s1">BufferedImage inputImage = ImageIO.read(inputFile)</span><span class="s0">;</span>
            <span class="s2">// create output image</span>
            <span class="s1">BufferedImage outputImage = </span><span class="s0">new </span><span class="s1">BufferedImage(scaledWidth</span><span class="s0">, </span><span class="s1">scaledHeight</span><span class="s0">, </span><span class="s1">inputImage.getType())</span><span class="s0">;</span>
            <span class="s2">// scales input image to the output image</span>
            <span class="s1">Graphics g2d = outputImage.createGraphics()</span><span class="s0">;</span>
            <span class="s1">g2d.drawImage(inputImage</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s1">scaledWidth</span><span class="s0">, </span><span class="s1">scaledHeight</span><span class="s0">, null</span><span class="s1">)</span><span class="s0">;</span>
            <span class="s1">g2d.dispose()</span><span class="s0">;</span>
            <span class="s2">// cut it up</span>
            <span class="s0">int </span><span class="s1">x = </span><span class="s4">0</span><span class="s0">, </span><span class="s1">y = </span><span class="s4">0</span><span class="s0">;</span>
            <span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s4">0</span><span class="s0">; </span><span class="s1">i &lt; mazeImage.GetHeight()</span><span class="s0">; </span><span class="s1">i++) {</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">j = </span><span class="s4">0</span><span class="s0">; </span><span class="s1">j &lt; mazeImage.GetWidth()</span><span class="s0">; </span><span class="s1">j++) {</span>
                    <span class="s2">// if i = 0 replace it with id of 5 and also top</span>
                    <span class="s0">int </span><span class="s1">topValue = </span><span class="s4">0</span><span class="s0">, </span><span class="s1">bottomValue = </span><span class="s4">0</span><span class="s0">, </span><span class="s1">leftValue = </span><span class="s4">0</span><span class="s0">, </span><span class="s1">rightValue = </span><span class="s4">0</span><span class="s0">;</span>
                    <span class="s0">if </span><span class="s1">(i == </span><span class="s4">0</span><span class="s1">){</span>
                        <span class="s1">topValue = </span><span class="s4">1</span><span class="s0">;</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(j == </span><span class="s4">0</span><span class="s1">){</span>
                        <span class="s1">leftValue = </span><span class="s4">1</span><span class="s0">;</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(j == mazeImage.GetWidth()-</span><span class="s4">1</span><span class="s1">){</span>
                        <span class="s1">rightValue = </span><span class="s4">1</span><span class="s0">;</span>
                    <span class="s1">}</span>
                    <span class="s0">if </span><span class="s1">(i == mazeImage.GetHeight()-</span><span class="s4">1</span><span class="s1">){</span>
                        <span class="s1">bottomValue = </span><span class="s4">1</span><span class="s0">;</span>
                    <span class="s1">}</span>
                    <span class="s1">ReplaceCell(</span><span class="s0">new </span><span class="s1">MazeDataCell(</span><span class="s4">5</span><span class="s0">,</span><span class="s1">leftValue</span><span class="s0">,</span><span class="s1">rightValue</span><span class="s0">,</span><span class="s1">topValue</span><span class="s0">,</span><span class="s1">bottomValue)</span><span class="s0">,</span>
                            <span class="s1">mazeImage.GetIndex() + j + (xDimension * i))</span><span class="s0">;</span>
                    <span class="s1">BufferedImage croppedImage = outputImage.getSubimage(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s4">2000 </span><span class="s1">/ xDimension</span><span class="s0">, </span><span class="s4">2000 </span><span class="s1">/ yDimension)</span><span class="s0">;</span>
                    <span class="s1">JLabel picLabel = </span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s0">new </span><span class="s1">ImageIcon(croppedImage))</span><span class="s0">;</span>
                    <span class="s0">this</span><span class="s1">.displayData[mazeImage.GetIndex() + j + (xDimension * i)].add(picLabel)</span><span class="s0">;</span>
                    <span class="s1">x = x + </span><span class="s4">2000 </span><span class="s1">/ xDimension</span><span class="s0">;</span>
                <span class="s1">}</span>
                <span class="s1">x = </span><span class="s4">0</span><span class="s0">;</span>
                <span class="s1">y = y + </span><span class="s4">2000 </span><span class="s1">/ yDimension</span><span class="s0">;</span>
            <span class="s1">}</span>
        <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s0">public boolean </span><span class="s1">Solve(){</span>

        <span class="s2">// Boolean list of explored cells</span>
        <span class="s1">Boolean[] exploredCells = </span><span class="s0">new </span><span class="s1">Boolean[mazeData.length]</span><span class="s0">;</span>
        <span class="s1">Arrays.fill(exploredCells</span><span class="s0">, false</span><span class="s1">)</span><span class="s0">;</span>

        <span class="s2">// Int list to keep track of parents</span>
        <span class="s0">int</span><span class="s1">[] parentCells = </span><span class="s0">new int</span><span class="s1">[mazeData.length]</span><span class="s0">;</span>

        <span class="s2">// An arraylist of the directions</span>
        <span class="s1">ArrayList&lt;Integer&gt; directions = </span><span class="s0">new </span><span class="s1">ArrayList&lt;&gt;()</span><span class="s0">;</span>

        <span class="s2">// Linked list of next cells to visit</span>
        <span class="s1">LinkedList&lt;Integer&gt; nextToVisit = </span><span class="s0">new </span><span class="s1">LinkedList&lt;&gt;()</span><span class="s0">;</span>
        <span class="s0">int </span><span class="s1">start = </span><span class="s4">0</span><span class="s0">;</span>
        <span class="s1">nextToVisit.add(start)</span><span class="s0">;</span>

        <span class="s2">// Remove a cell from the list and analyse it</span>
        <span class="s0">while </span><span class="s1">(!nextToVisit.isEmpty()){</span>

            <span class="s0">int </span><span class="s1">cur = nextToVisit.remove()</span><span class="s0">;</span>

            <span class="s1">System.out.println(</span><span class="s3">&quot;Checking cell index &quot; </span><span class="s1">+ cur)</span><span class="s0">;</span>

            <span class="s2">// If it is found then return</span>
            <span class="s0">if </span><span class="s1">(mazeData[cur].getValue() == </span><span class="s4">3</span><span class="s1">){</span>
                <span class="s1">System.out.println(</span><span class="s3">&quot;Solution found&quot;</span><span class="s1">)</span><span class="s0">;</span>
                <span class="s0">int </span><span class="s1">parent = parentCells[mazeData.length-</span><span class="s4">1</span><span class="s1">]</span><span class="s0">;</span>
                <span class="s0">while </span><span class="s1">(parent != </span><span class="s4">0</span><span class="s1">){</span>
                    <span class="s1">directions.add(parent)</span><span class="s0">;</span>
                    <span class="s1">parent = parentCells[parent]</span><span class="s0">;</span>
                <span class="s1">}</span>
                <span class="s0">this</span><span class="s1">.solutionDirections = directions</span><span class="s0">;</span>
                <span class="s0">double </span><span class="s1">cellsReached2 = (</span><span class="s0">double</span><span class="s1">)solutionDirections.size()/(xDimension*yDimension)</span><span class="s0">;</span>
                <span class="s0">this</span><span class="s1">.cellsReached = (</span><span class="s0">int</span><span class="s1">)(cellsReached2 * </span><span class="s4">100</span><span class="s1">)</span><span class="s0">;</span>


                <span class="s2">// Get dead ends</span>
                <span class="s0">int </span><span class="s1">deadEnds = </span><span class="s4">0</span><span class="s0">;</span>
                <span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s4">0</span><span class="s0">; </span><span class="s1">i &lt; mazeData.length</span><span class="s0">; </span><span class="s1">i++){</span>
                    <span class="s0">int </span><span class="s1">total = mazeData[i].getWallAbove() + mazeData[i].getWallRight() + mazeData[i].getWallLeft() +</span>
                            <span class="s1">mazeData[i].getWallBelow()</span><span class="s0">;</span>
                    <span class="s0">if </span><span class="s1">(total &gt; </span><span class="s4">2</span><span class="s1">){</span>
                        <span class="s1">deadEnds++</span><span class="s0">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>
                <span class="s0">double </span><span class="s1">deadEnds2 = (</span><span class="s0">double</span><span class="s1">)deadEnds/(xDimension*yDimension)</span><span class="s0">;</span>
                <span class="s0">this</span><span class="s1">.deadEnds = (</span><span class="s0">int</span><span class="s1">)(deadEnds2 * </span><span class="s4">100</span><span class="s1">)</span><span class="s0">;</span>


                <span class="s0">return true;</span>
            <span class="s1">}</span>

            <span class="s2">// if not then mark it as visited</span>
            <span class="s0">else </span><span class="s1">{</span>

                <span class="s2">// mark it as explored</span>
                <span class="s1">exploredCells[cur] = </span><span class="s0">true;</span>

                <span class="s2">// add all neighbours to the list if they are valid</span>

                <span class="s2">// add the right neighbour</span>
                <span class="s0">if </span><span class="s1">(mazeData[cur].getWallRight() == </span><span class="s4">0</span><span class="s1">){</span>
                    <span class="s0">if </span><span class="s1">(!exploredCells[cur + </span><span class="s4">1</span><span class="s1">]){</span>
                        <span class="s1">nextToVisit.add(cur + </span><span class="s4">1</span><span class="s1">)</span><span class="s0">;</span>
                        <span class="s2">//</span>
                        <span class="s1">parentCells[cur + </span><span class="s4">1</span><span class="s1">] = cur</span><span class="s0">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>

                <span class="s2">// add the bottom neighbour</span>
                <span class="s0">if </span><span class="s1">(mazeData[cur].getWallBelow() == </span><span class="s4">0</span><span class="s1">){</span>
                    <span class="s0">if </span><span class="s1">(!exploredCells[cur + xDimension]){</span>
                        <span class="s1">nextToVisit.add(cur + xDimension)</span><span class="s0">;</span>
                        <span class="s1">parentCells[cur + xDimension] = cur</span><span class="s0">;</span>
                    <span class="s1">}</span>
                <span class="s1">}</span>

                    <span class="s2">// add the top neighbour</span>
                    <span class="s0">if </span><span class="s1">(mazeData[cur].getWallAbove() == </span><span class="s4">0</span><span class="s1">){</span>
                        <span class="s0">if </span><span class="s1">(!exploredCells[cur - xDimension]){</span>
                            <span class="s1">nextToVisit.add(cur - xDimension)</span><span class="s0">;</span>
                            <span class="s1">parentCells[cur - xDimension] = cur</span><span class="s0">;</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>

                    <span class="s2">// add the left neighbour</span>
                    <span class="s0">if </span><span class="s1">(mazeData[cur].getWallLeft() == </span><span class="s4">0</span><span class="s1">){</span>
                        <span class="s1">System.out.println(</span><span class="s3">&quot;Wall left is free &quot; </span><span class="s1">+ cur)</span><span class="s0">;</span>
                        <span class="s0">if </span><span class="s1">(!exploredCells[cur - </span><span class="s4">1</span><span class="s1">]){</span>
                            <span class="s1">nextToVisit.add(cur - </span><span class="s4">1</span><span class="s1">)</span><span class="s0">;</span>
                            <span class="s1">parentCells[cur - </span><span class="s4">1</span><span class="s1">] = cur</span><span class="s0">;</span>
                        <span class="s1">}</span>
                    <span class="s1">}</span>
            <span class="s1">}</span>

        <span class="s1">}</span>
        <span class="s0">return false;</span>
    <span class="s1">}</span>

    <span class="s0">public void </span><span class="s1">PublishMaze() </span><span class="s0">throws </span><span class="s1">IOException {</span>

        <span class="s1">GenerateDisplayData()</span><span class="s0">;</span>
        <span class="s1">UI.getInstance().display.SetDisplayedMaze(</span><span class="s0">this</span><span class="s1">)</span><span class="s0">;</span>

        <span class="s2">// Set the width and height</span>
        <span class="s2">// divide by 4.</span>
        <span class="s0">int </span><span class="s1">width = </span><span class="s4">2000</span><span class="s0">;</span>
        <span class="s0">int </span><span class="s1">height = </span><span class="s4">2000</span><span class="s0">;</span>
        <span class="s5">/**</span>
        <span class="s5">if (xDimension &lt; 30){</span>
            <span class="s5">width = 64 * xDimension;</span>
        <span class="s5">} else if (xDimension &lt; 50){</span>
            <span class="s5">width = 40 * xDimension;</span>
        <span class="s5">} else if (xDimension &lt; 80){</span>
            <span class="s5">width = 16 * xDimension;</span>
        <span class="s5">}</span>
        <span class="s5">if (yDimension &lt; 30){</span>
            <span class="s5">height = 64 * yDimension;</span>
        <span class="s5">} else if (yDimension &lt; 50){</span>
            <span class="s5">height = 40 * yDimension;</span>
        <span class="s5">} else if (yDimension &lt; 80){</span>
            <span class="s5">height = 16*yDimension;</span>
        <span class="s5">}*/</span>

        <span class="s2">// create a new JPanel and populate with displayData</span>
        <span class="s1">JPanel imageCanvas = </span><span class="s0">new </span><span class="s1">JPanel()</span><span class="s0">;</span>
        <span class="s1">imageCanvas.setLayout(</span><span class="s0">new </span><span class="s1">GridLayout(yDimension</span><span class="s0">,</span><span class="s1">xDimension))</span><span class="s0">;</span>
        <span class="s1">imageCanvas.setPreferredSize(</span><span class="s0">new </span><span class="s1">Dimension(width</span><span class="s0">,</span><span class="s1">height))</span><span class="s0">;</span>
        <span class="s1">imageCanvas.setBackground(Color.GRAY)</span><span class="s0">;</span>
        <span class="s1">imageCanvas.setBackground(Color.WHITE)</span><span class="s0">;</span>
        <span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s4">0</span><span class="s0">; </span><span class="s1">i &lt; </span><span class="s0">this</span><span class="s1">.xDimension*</span><span class="s0">this</span><span class="s1">.yDimension</span><span class="s0">; </span><span class="s1">i++){</span><span class="s0">;</span>
            <span class="s1">imageCanvas.add(displayData[i])</span><span class="s0">;</span>
        <span class="s1">}</span>

        <span class="s2">// create a jframe to check</span>
        <span class="s1">JFrame frame = </span><span class="s0">new </span><span class="s1">JFrame()</span><span class="s0">;</span>
        <span class="s1">frame.add(imageCanvas)</span><span class="s0">;</span>
        <span class="s1">frame.setVisible(</span><span class="s0">true</span><span class="s1">)</span><span class="s0">;</span>
        <span class="s1">frame.pack()</span><span class="s0">;</span>

        <span class="s2">// save that JPanel</span>
        <span class="s1">BufferedImage image = </span><span class="s0">new </span><span class="s1">BufferedImage(width</span><span class="s0">,</span><span class="s1">height</span><span class="s0">,</span><span class="s1">BufferedImage.TYPE_INT_RGB)</span><span class="s0">;</span>
        <span class="s1">Graphics2D g2 = image.createGraphics()</span><span class="s0">;</span>
        <span class="s1">imageCanvas.paint(g2)</span><span class="s0">;</span>
        <span class="s0">try</span><span class="s1">{</span>
            <span class="s1">ImageIO.write(image</span><span class="s0">,</span><span class="s3">&quot;jpeg&quot;</span><span class="s0">,new </span><span class="s1">File(</span><span class="s0">this</span><span class="s1">.name+</span><span class="s3">&quot;.jpeg&quot;</span><span class="s1">))</span><span class="s0">;</span>
        <span class="s1">} </span><span class="s0">catch </span><span class="s1">(IOException e) {</span>
            <span class="s1">e.printStackTrace()</span><span class="s0">;</span>
        <span class="s1">}</span>
    <span class="s1">}</span>



<span class="s1">}</span>
</pre>
</body>
</html>